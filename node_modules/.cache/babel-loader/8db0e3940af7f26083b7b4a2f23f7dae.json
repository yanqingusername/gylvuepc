{"remainingRequest":"/Users/user/coyote/vue2-dynamic-routing/node_modules/babel-loader/lib/index.js!/Users/user/coyote/vue2-dynamic-routing/src/router/router-config.js","dependencies":[{"path":"/Users/user/coyote/vue2-dynamic-routing/src/router/router-config.js","mtime":1657098512584},{"path":"/Users/user/coyote/vue2-dynamic-routing/node_modules/cache-loader/dist/cjs.js","mtime":1657098570134},{"path":"/Users/user/coyote/vue2-dynamic-routing/node_modules/babel-loader/lib/index.js","mtime":1657098570101}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL1VzZXJzL3VzZXIvY295b3RlL3Z1ZTItZHluYW1pYy1yb3V0aW5nL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy91c2VyL2NveW90ZS92dWUyLWR5bmFtaWMtcm91dGluZy9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCByb3V0ZXIgZnJvbSAiLi9pbmRleCI7CmltcG9ydCBMYXlvdXQgZnJvbSAiLi4vbGF5b3V0L2luZGV4IjsKaW1wb3J0IE5Qcm9ncmVzcyBmcm9tICducHJvZ3Jlc3MnOyAvLyBwcm9ncmVzcyBiYXIKCk5Qcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZQp9KTsgLy8gTlByb2dyZXNzIENvbmZpZ3VyYXRpb24KCnZhciBmaWx0ZXJSb3V0ZXMgPSBbIi9sb2dpbiJdOyAvLyDpnIDopoHov4fmu6TmjonnmoTot6/nlLEKCnJvdXRlci5iZWZvcmVFYWNoKGZ1bmN0aW9uICh0bywgZnJvbSwgbmV4dCkgewogIC8vIHN0YXJ0IHByb2dyZXNzIGJhcgogIE5Qcm9ncmVzcy5zdGFydCgpOyAvLyDojrflj5bot6/nlLEgbWV0YSDkuK3nmoR0aXRsZe+8jOW5tuiuvue9rue7memhtemdouagh+mimAoKICBkb2N1bWVudC50aXRsZSA9ICLliqjmgIHot6/nlLEoIiArIHRvLm1ldGEudGl0bGUgKyAiKSI7IC8vIOWIpOaWrei3r+eUseaMh+WQkeaYr+WQpuWcqOmcgOimgei/h+a7pOeahOi3r+eUseWcsOWdgOaVsOe7hOmHjAogIC8vIOWmguaenOWcqO+8jOWImeebtOaOpei3s+i/m+mhtemdou+8jOaXoOmcgOWIpOaWrQoKICBpZiAoZmlsdGVyUm91dGVzLmluZGV4T2YodG8ucGF0aCkgIT09IC0xKSB7CiAgICBuZXh0KCk7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICBpZiAocm91dGVyLm9wdGlvbnMucm91dGVzLmxlbmd0aCA9PSAxKSB7CiAgICB2YXIgX0pTT04kcGFyc2U7CgogICAgLy8g6I635Y+WdG9rZW7lkozljp/lp4vot6/nlLHmlbDnu4QKICAgIHZhciB1c2VySW5mbyA9IChfSlNPTiRwYXJzZSA9IEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW5mbycpKSkgIT09IG51bGwgJiYgX0pTT04kcGFyc2UgIT09IHZvaWQgMCA/IF9KU09OJHBhcnNlIDogIiI7IC8vIOW9k3Rva2Vu5ZKM5Y6f5aeL6Lev55Sx6YO95a2Y5Zyo55qE5pe25YCZCgogICAgaWYgKHVzZXJJbmZvLnRva2VuICYmIHVzZXJJbmZvLnJvdXRlcykgb25GaWx0ZXJSb3V0ZXModG8sIG5leHQsIHVzZXJJbmZvLnJvdXRlcyk7IC8vIOaJp+ihjOi3r+eUsei/h+a7pOWSjOi3s+i9rAogICAgZWxzZSBuZXh0KHsKICAgICAgcGF0aDogIi9sb2dpbiIsCiAgICAgIHJlcGxhY2U6IHRydWUKICAgIH0pOwogIH0gZWxzZSBuZXh0KCk7Cn0pOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICAvLyBmaW5pc2ggcHJvZ3Jlc3MgYmFyCiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7IC8vIOi3r+eUseaLvOaOpQoKZnVuY3Rpb24gbG9hZFZpZXcodmlldykgewogIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gaW1wb3J0KCJAL3ZpZXdzLyIuY29uY2F0KHZpZXcpKTsKICB9Owp9IC8vIOi3r+eUsei/h+a7pOWSjOi3s+i9rAoKCmZ1bmN0aW9uIG9uRmlsdGVyUm91dGVzKF94LCBfeDIsIF94MykgewogIHJldHVybiBfb25GaWx0ZXJSb3V0ZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfSAvLyDot6/nlLHov4fmu6QgICDpgY3ljobot6/nlLEg6L2s5o2i5Li657uE5Lu25a+56LGh5ZKM6Lev5b6ECgoKZnVuY3Rpb24gX29uRmlsdGVyUm91dGVzKCkgewogIF9vbkZpbHRlclJvdXRlcyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh0bywgbmV4dCwgZSkgewogICAgdmFyIHJvdXRlczsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICB3aGlsZSAoMSkgewogICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI7CiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJBU3luY1JvdXRlcyhlKTsKCiAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIHJvdXRlcyA9IF9jb250ZXh0LnNlbnQ7CiAgICAgICAgICAgIC8vIOi3r+eUsei/h+a7pAogICAgICAgICAgICByb3V0ZXMuc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICAgIHJldHVybiBhWydpZCddIC0gYlsnaWQnXTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJvdXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgcm91dGVyLm9wdGlvbnMucm91dGVzLnB1c2goaXRlbSk7CiAgICAgICAgICAgICAgcm91dGVyLmFkZFJvdXRlKGl0ZW0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbmV4dChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRvKSwge30sIHsKICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgfSwgX2NhbGxlZSk7CiAgfSkpOwogIHJldHVybiBfb25GaWx0ZXJSb3V0ZXMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKfQoKZnVuY3Rpb24gZmlsdGVyQVN5bmNSb3V0ZXMoZGF0YSkgewogIHZhciByb3V0ZXMgPSBkYXRhLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgaWYgKGl0ZW1bImNvbXBvbmVudCJdID09PSAiTGF5b3V0IikgaXRlbS5jb21wb25lbnQgPSBMYXlvdXQ7ZWxzZSBpdGVtWyJjb21wb25lbnQiXSA9IGxvYWRWaWV3KGl0ZW1bImNvbXBvbmVudCJdKTsgLy8g6Lev55Sx6YCS5b2S77yM6L2s5o2i57uE5Lu25a+56LGh5ZKM6Lev5b6ECgogICAgaWYgKGl0ZW1bImNoaWxkcmVuIl0gJiYgaXRlbVsiY2hpbGRyZW4iXS5sZW5ndGggPiAwKSBpdGVtWyJjaGlsZHJlbiJdID0gZmlsdGVyQVN5bmNSb3V0ZXMoaXRlbS5jaGlsZHJlbik7CiAgICByZXR1cm4gdHJ1ZTsKICB9KTsKICByZXR1cm4gcm91dGVzOwp9"},{"version":3,"sources":["/Users/user/coyote/vue2-dynamic-routing/src/router/router-config.js"],"names":["router","Layout","NProgress","configure","showSpinner","filterRoutes","beforeEach","to","from","next","start","document","title","meta","indexOf","path","options","routes","length","userInfo","JSON","parse","window","localStorage","getItem","token","onFilterRoutes","replace","afterEach","done","loadView","view","e","filterASyncRoutes","sort","a","b","forEach","item","push","addRoute","data","filter","component","children"],"mappings":"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","sourcesContent":["import router from \"./index\"\nimport Layout from \"../layout/index\"\nimport NProgress from 'nprogress' // progress bar\n\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\n\nconst filterRoutes = [\"/login\"]   // 需要过滤掉的路由\nrouter.beforeEach((to, from, next) => {\n    // start progress bar\n    NProgress.start()\n\n    // 获取路由 meta 中的title，并设置给页面标题\n    document.title = \"动态路由(\" + to.meta.title + \")\"\n    \n    // 判断路由指向是否在需要过滤的路由地址数组里\n    // 如果在，则直接跳进页面，无需判断\n    if(filterRoutes.indexOf(to.path) !== -1) {\n        next()\n        return false\n    }\n    if(router.options.routes.length == 1) {\n        // 获取token和原始路由数组\n        const userInfo = JSON.parse(window.localStorage.getItem('userInfo')) ?? \"\"\n        // 当token和原始路由都存在的时候\n        if(userInfo.token && userInfo.routes) onFilterRoutes(to, next, userInfo.routes)  // 执行路由过滤和跳转\n        else next({ path: \"/login\", replace: true })\n    } else next()\n})\n\nrouter.afterEach(() => {\n    // finish progress bar\n    NProgress.done()\n})\n\n// 路由拼接\nfunction loadView(view) {\n    return () => import(`@/views/${ view }`)\n}\n\n// 路由过滤和跳转\nasync function onFilterRoutes(to, next, e) {\n    const routes = await filterASyncRoutes(e)    // 路由过滤\n    routes.sort((a, b) => a['id'] - b['id'])\n    routes.forEach(item => {\n        router.options.routes.push(item)\n        router.addRoute(item)\n    })\n    next({ ...to, replace: true })\n}\n\n// 路由过滤   遍历路由 转换为组件对象和路径\nfunction filterASyncRoutes(data) {\n    const routes = data.filter(item => {\n        if(item[\"component\"] === \"Layout\") item.component = Layout\n        else item[\"component\"] = loadView(item[\"component\"])\n        // 路由递归，转换组件对象和路径\n        if(item[\"children\"] && item[\"children\"].length > 0) item[\"children\"] = filterASyncRoutes(item.children)\n        return true\n    })\n    return routes\n}"]}]}